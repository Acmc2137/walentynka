<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<title>Walentynka ‚ù§Ô∏è</title>

<style>
body{
  margin:0;
  height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  background:#f6c1d1;
  font-family:Arial, sans-serif;
  overflow:hidden;
}

.container{
  width:750px;
  height:520px;
  background:white;
  border-radius:30px;
  padding:30px;
  box-sizing:border-box;
  text-align:center;
  position:relative;
  z-index:3;
  box-shadow:0 20px 40px rgba(0,0,0,0.25);
}

h1{ color:#c2185b; margin-bottom:30px; }

.buttons{
  width:360px;
  height:220px;
  margin:0 auto;
  position:relative;
}

button{
  position:absolute;
  padding:12px 26px;
  font-size:20px;
  border:none;
  border-radius:30px;
  cursor:pointer;
  white-space:nowrap;
  z-index:4;
  transition:left 0.25s ease, top 0.25s ease;
}

#yes{
  background:#ff5c8a;
  color:white;
  left:50%;
  top:40px;
  transform:translateX(-50%);
}

#no{
  background:#ddd;
  left:50%;
  top:120px;
  transform:translateX(-50%);
}

.love-box{
  display:none;
  margin-top:10px;
  position:relative;
  z-index:4;
}
.love-box h2{ color:#e91e63; margin-bottom:15px; }
.love-box img{ max-width:240px; border-radius:20px; }

/* PNG */
.flying{
  position:fixed;
  width:180px;
  pointer-events:none;
  z-index:1;
}

/* SERDUSZKA */
.heart{
  position:fixed;
  top:-30px;
  font-size:24px;
  animation:fall linear infinite;
  opacity:0.85;
  pointer-events:none;
  z-index:0;
}
@keyframes fall{ to{ transform:translateY(110vh); } }
</style>
</head>

<body>

<div class="container" id="container">
  <h1 id="question">Zuzia, zostaniesz mojƒÖ walentynkƒÖ? üíò</h1>

  <div class="buttons" id="buttonsBox">
    <button id="yes">TAK</button>
    <button id="no">nie</button>
  </div>

  <div class="love-box" id="loveBox">
    <h2>Kocham Ciƒô minio ‚ù§Ô∏è</h2>
    <img src="nasze-zdjecie.jpg" alt="Nasze zdjƒôcie">
  </div>
</div>

<script>
/* ‚ù§Ô∏è SERDUSZKA */
function createHeart(){
  const h=document.createElement("div");
  h.className="heart";
  h.textContent="‚ù§Ô∏è";
  h.style.left=Math.random()*100+"vw";
  h.style.fontSize=(18+Math.random()*20)+"px";
  h.style.animationDuration=(4+Math.random()*4)+"s";
  document.body.appendChild(h);
  setTimeout(()=>h.remove(),8000);
}
setInterval(createHeart,350);

/* üôÖ PRZYCISK NIE ‚Äì p≈Çynne uciekanie + cooldown tekstu */
const noBtn=document.getElementById("no");
const box=document.getElementById("buttonsBox");
const texts=["nie","serio?","ej üò≥","no we≈∫","üíî"];
let textIndex=0, lastChange=0;

noBtn.addEventListener("mousemove",(e)=>{
  const now=Date.now();
  const boxRect=box.getBoundingClientRect();
  const btnRect=noBtn.getBoundingClientRect();

  const dx=(btnRect.left+btnRect.width/2)-e.clientX;
  const dy=(btnRect.top+btnRect.height/2)-e.clientY;
  const dist=Math.hypot(dx,dy);

  if(dist<120){
    const angle=Math.atan2(dy,dx);
    const move=35;

    let left=(btnRect.left-boxRect.left)+Math.cos(angle)*move;
    let top =(btnRect.top -boxRect.top )+Math.sin(angle)*move;

    left=Math.max(0,Math.min(box.clientWidth-btnRect.width,left));
    top =Math.max(0,Math.min(box.clientHeight-btnRect.height,top));

    noBtn.style.left=left+"px";
    noBtn.style.top =top +"px";

    if(now-lastChange>600 && textIndex<texts.length-1){
      textIndex++;
      noBtn.textContent=texts[textIndex];
      lastChange=now;
    }
  }
});

/* ‚úÖ TAK */
const yesBtn=document.getElementById("yes");
const loveBox=document.getElementById("loveBox");
const question=document.getElementById("question");
const container=document.getElementById("container");

yesBtn.addEventListener("click",()=>{
  document.getElementById("buttonsBox").style.display="none";
  question.style.display="none";
  loveBox.style.display="block";
  startFlyingPNG();
});

/* üñºÔ∏è PNG ‚Äì latajƒÖ POZA boxem i odbijajƒÖ siƒô od niego bez ‚Äúklejenia‚Äù */
function startFlyingPNG(){
  const pngs = [];
  const count = 12;     // ‚úÖ wiƒôcej PNG
  const size  = 180;    // musi pasowaƒá do .flying width
  const EPS   = 3;      // odskok od przeszkody, ≈ºeby nie ≈Çapa≈Ço kolizji co klatkƒô
  const BOX_COOLDOWN_FRAMES = 8;

  function randSpeed(){
    const s = Math.random()*2.2 + 2.8; // 2.8..5.0
    return s * (Math.random()<0.5 ? -1 : 1);
  }

  function intersectsBox(x,y,s, r){
    return (x+s > r.left && x < r.right && y+s > r.top && y < r.bottom);
  }

  function ensureMinSpeed(p){
    const min = 2.0;
    if (Math.abs(p.vx) < min) p.vx = min * Math.sign(p.vx || 1);
    if (Math.abs(p.vy) < min) p.vy = min * Math.sign(p.vy || 1);
  }

  function kick(p){
    p.vx += (Math.random()*0.6 - 0.3);
    p.vy += (Math.random()*0.6 - 0.3);
    ensureMinSpeed(p);
  }

  function resolveAgainstBox(p, r){
    const leftPen   = (p.x + size) - r.left;
    const rightPen  = r.right - p.x;
    const topPen    = (p.y + size) - r.top;
    const bottomPen = r.bottom - p.y;

    const minPen = Math.min(leftPen, rightPen, topPen, bottomPen);

    if (minPen === leftPen) {
      p.x = r.left - size - EPS;
      p.vx = -Math.abs(p.vx);
    } else if (minPen === rightPen) {
      p.x = r.right + EPS;
      p.vx = Math.abs(p.vx);
    } else if (minPen === topPen) {
      p.y = r.top - size - EPS;
      p.vy = -Math.abs(p.vy);
    } else {
      p.y = r.bottom + EPS;
      p.vy = Math.abs(p.vy);
    }

    kick(p);
    p.boxCd = BOX_COOLDOWN_FRAMES;
  }

  // START: losowo na ekranie, ale NIE w boxie
  const boxRect0 = container.getBoundingClientRect();
  for (let i=0; i<count; i++){
    const img = document.createElement("img");
    img.src = "meme1.png";
    img.className = "flying";
    document.body.appendChild(img);

    let x, y;
    do {
      x = Math.random()*(window.innerWidth  - size);
      y = Math.random()*(window.innerHeight - size);
    } while (intersectsBox(x,y,size, boxRect0));

    pngs.push({ el: img, x, y, vx: randSpeed(), vy: randSpeed(), boxCd: 0 });
  }

  function animate(){
    const boxRect = container.getBoundingClientRect();

    pngs.forEach(p=>{
      if (p.boxCd > 0) p.boxCd--;

      p.x += p.vx;
      p.y += p.vy;

      // odbicia od krawƒôdzi ekranu
      if (p.x <= 0){
        p.x = 0; p.vx = Math.abs(p.vx); kick(p);
      } else if (p.x >= window.innerWidth - size){
        p.x = window.innerWidth - size; p.vx = -Math.abs(p.vx); kick(p);
      }

      if (p.y <= 0){
        p.y = 0; p.vy = Math.abs(p.vy); kick(p);
      } else if (p.y >= window.innerHeight - size){
        p.y = window.innerHeight - size; p.vy = -Math.abs(p.vy); kick(p);
      }

      // kolizja z boxem (przeszkodƒÖ) ‚Äî z cooldownem i wypchniƒôciem
      if (p.boxCd === 0 && intersectsBox(p.x, p.y, size, boxRect)){
        resolveAgainstBox(p, boxRect);
      }

      p.el.style.left = p.x + "px";
      p.el.style.top  = p.y + "px";
    });

    requestAnimationFrame(animate);
  }

  animate();
}
</script>

</body>
</html>
